# Поиск изображений по текстовым описаниям (PoC)

## Описание проекта
Этот проект выполнен в рамках разработки Proof of Concept (PoC) для фотохостинга **«Со Смыслом» (“With Sense”)**.  
Платформа предназначена для профессиональных фотографов, которые размещают свои снимки и сопровождают их описаниями: местоположение, модель камеры и другие детали.  
Особенность сервиса заключается в том, что описания могут добавлять не только авторы фотографий, но и другие пользователи.  

Цель проекта — создать демонстрационную версию поиска изображений по текстовым запросам.  
Для этого необходимо построить модель, которая:
- получает на вход изображение и текстовое описание,
- преобразует их в векторные представления,
- возвращает вероятность (от 0 до 1) того, что текст соответствует изображению.

Итогом работы станет базовая версия продукта, которая может быть представлена руководству компании для принятия решения о дальнейшем развитии.

## Юридические ограничения
В странах, где работает сервис, действуют законодательные ограничения на обработку изображений, содержащих детей (лица младше 16 лет).  
Поисковым системам запрещено без разрешения родителей или законных представителей предоставлять такие данные.  

В боевой версии сервиса при попытке открыть запрещённое изображение пользователю показывается дисклеймер:  


В рамках PoC реализовать этот функционал невозможно, поэтому на этапе подготовки данных выполняется очистка:  
- изображения и описания, содержащие упоминания детей, удаляются из выборки,  
- при тестировании модели такие запросы должны заменяться дисклеймером.  

## Данные
Проект использует следующие данные:

- **`train_dataset.csv`** — обучающая выборка:  
  - имя файла изображения,  
  - идентификатор описания (`<имя файла>#<номер>`),  
  - текст описания.  
  Для одной картинки доступно до 5 описаний.  

- **Папка `train_images`** — изображения для обучения.  

- **`CrowdAnnotations.tsv`** — данные краудсорсинговых аннотаций:  
  1. имя файла изображения,  
  2. идентификатор описания,  
  3. доля подтверждений соответствия,  
  4. количество подтверждений,  
  5. количество отклонений.  

- **`ExpertAnnotations.tsv`** — экспертные оценки соответствия:  
  - имя файла изображения,  
  - идентификатор описания,  
  - оценки трёх экспертов по шкале от 1 до 4:  
    - 1 — текст и изображение не соответствуют,  
    - 2 — частичное соответствие,  
    - 3 — соответствие с неточностями,  
    - 4 — полное соответствие.  

- **`test_queries.csv`** — тестовая выборка:  
  - идентификатор запроса,  
  - текст запроса,  
  - релевантное изображение.  
  Для одной картинки доступно до 5 описаний.  

- **Папка `test_images`** — изображения для тестирования.  

## Основные этапы работы
1. Загрузка и первичный анализ данных.  
2. Очистка выборки от запрещённого контента.  
3. Формирование целевого признака на основе экспертных и краудсорсинговых оценок.  
4. Векторизация изображений (ResNet50) и текстов (TF-IDF).  
5. Объединение признаков в единый датасет.  
6. Обучение и сравнение нескольких моделей.  
7. Анализ результатов и формирование выводов.  

## Результаты
В результате был построен полный пайплайн обработки данных и обучения моделей.  
Однако из-за значительного уменьшения объёма данных после очистки качество моделей оказалось низким: ни одна из них не смогла превзойти по метрикам базовый DummyRegressor.  

Для улучшения результатов необходимы:
- расширение объёма обучающей выборки,  
- использование дополнительных методов обработки изображений и текстов,  
- тюнинг гиперпараметров и ансамблирование моделей.  
